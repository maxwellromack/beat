<!DOCTYPE html>
<html>
    <head>
        <title>Radio Website</title>
        <link rel="stylesheet" href="stylesheet.css">
        <script src="script.js"></script>
    </head>
    <body>
        <div class="sidebar">
            <img src="img/sample_img.webp" alt="Profile Picture" class="pfp">
            <p style="font-size: 20px;text-align: center;"><%= username %></p> 
            <a href="#playlist">Current Playlist</a>
            <a href="#add_songs">Add Songs</a>
            <a href="#select_dj">Select DJ</a>
            <a href="#select_timeslot">Select Timeslot</a>
        </div>
        <div class="flex-container">
            <div>
                <!-- Current Playlist Block-->
                <h1>Current Playlist</h1>
                <div class="container" id="playlist-container">
                    <div class="song">
                        <img src ="img/sample_img.webp" class="album-art">
                        A song
                        <audio controls>
                            <source src="aud/nice_sound.mp3" type="audio/mp3">
                        </audio>
                    </div>
                </div>
            </div>
            <!-- Song Add Block -->
            <div>
                <h1>Add Songs</h1>
                <div class="container" id="add_song_container">
                    <!-- Songs will be displayed here -->
                </div>
                <script> // Fetch and display songs
                    async function display_songs() {
                        try {
                            const response = await fetch('/database/songs');
                            const songs = await response.json();
                
                            const songs_container = document.getElementById('add_song_container');
                
                            songs.forEach(song => {
                                const song_div = document.createElement('div');
                                song_div.classList.add('song');
                
                                const img = document.createElement('img');
                                img.src = song.album_art;
                                img.classList.add('album-art');
                                song_div.appendChild(img);
                
                                const song_title = document.createElement('p');
                                song_title.textContent = song.title;
                                song_title.classList.add('inline');
                                song_div.appendChild(song_title);
                
                                const add_button = document.createElement('img');
                                add_button.src = 'img/add.png';
                                add_button.classList.add('add-button');
                                add_button.onclick = function() {
                                    // Logic to add the song to the playlist when clicked
                                    // This logic will depend on your application's functionality
                                    // It might involve sending the song information to the backend or manipulating the playlist
                                };
                                song_div.appendChild(add_button);
                                songs_container.appendChild(song_div);
                            });
                        } catch (err) {
                            console.error(err);
                        }
                    }
                    window.onload = display_songs;
                </script>
            </div>
            <!-- Select DJ Block -->
            <div>
                <h1>Select DJ</h1>
                <div class="container">
                    <div class="dj" onclick="toggleActive(this)">
                        <img src ="img/sample_img.webp" class="album-art">
                        DJ Bunny
                    </div>
                    <div class="dj" onclick="toggleActive(this)">
                        <img src ="img/sample_img.webp" class="album-art">
                        DJ Rabbit
                    </div>
                    <div class="dj" onclick="toggleActive(this)">
                        <img src ="img/sample_img.webp" class="album-art">
                        DJ Lagomorph
                    </div>
                    <div class="dj" onclick="toggleActive(this)">
                        <img src ="img/sample_img.webp" class="album-art">
                        DJ Carrots
                    </div>
                    <div class="dj" onclick="toggleActive(this)">
                        <img src ="img/sample_img.webp" class="album-art">
                        DJ Hay
                    </div>
                </div>
            </div>
            <!-- Select Time Slot Block-->
            <div>
                <h1>Select Time Slot</h1>
                <div style="height: auto; width: 600px; border: 1px solid gold; padding: 10px;  ">
                    <form>
                        <label for="start_time">Start Time:</label>
                        <input type="text" id="start_time" name="start_time">
                        <label for="end_time">End Time:</label>
                        <input type="text" id="end_time" name="end_time">
                        <input type="button" value="Check Timeslot" onclick="validateTimes()">
                    </form>
                    <div id="error-popup" style="display: none;">
                        <p id="error-message" style="color: red;"></p>
                    </div>
                </div>
            </div>
            <!-- TODO: Playlist submission when we get database setup-->
            <button class="submit-button">Submit</button>
            <button class="reset-button" id="reset-button">Reset</button>

            <script>
                document.getElementById("reset-button").addEventListener("click", function () {
                    // Get the playlist container
                    const playlistContainer = document.getElementById("playlist-container");
        
                    // Remove all child elements (songs) from the container
                    while (playlistContainer.firstChild) {
                        playlistContainer.removeChild(playlistContainer.firstChild);
                    }
                });
            </script>
        </div>
    </body>
</html>
